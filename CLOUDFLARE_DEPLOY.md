# â˜ï¸ Cloudflare Pages éƒ¨ç½²æŒ‡å—

## âš ï¸ é‡è¦æç¤º

**å½“å‰é…ç½®**: Next.js 14 + App Router
**éƒ¨ç½²æ–¹å¼**: æ ‡å‡†æ„å»ºï¼ˆæ”¯æŒ API è·¯ç”±å’Œä¸­é—´ä»¶ï¼‰

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èæ–¹æ³•ï¼‰

### æ–¹æ³• 1: GitHub è¿æ¥ï¼ˆæœ€ç®€å•ï¼‰

1. **æ¨é€ä»£ç åˆ° GitHub**
   ```bash
   git add .
   git commit -m "éƒ¨ç½²å‡†å¤‡"
   git push origin main
   ```

2. **Cloudflare Dashboard è®¾ç½®**
   - è®¿é—® https://dash.cloudflare.com
   - Workers & Pages â†’ Create â†’ Pages
   - é€‰æ‹© **Connect to Git**
   - é€‰æ‹©ä½ çš„ä»“åº“ `wuyueerhao/pngtowebp`

3. **æ„å»ºé…ç½®**
   ```
   æ„å»ºå‘½ä»¤: npm run build
   æ„å»ºè¾“å‡ºç›®å½•: .next
   ```

4. **ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰**
   ```
   NEXT_PUBLIC_MAX_FILE_SIZE=50MB
   NEXT_PUBLIC_MAX_BATCH_SIZE=20
   ```

5. **ä¿å­˜å¹¶éƒ¨ç½²**

### æ–¹æ³• 2: Wrangler CLI

```bash
# å®‰è£… Wrangler
npm install -g wrangler

# ç™»å½•
wrangler login

# æ„å»º
npm run build

# éƒ¨ç½²
wrangler pages deploy .next --project-name=pngtowebp
```

### æ–¹æ³• 3: ç›´æ¥ä¸Šä¼ 

1. è¿è¡Œ `npm run build`
2. ä¸Šä¼  `.next` æ–‡ä»¶å¤¹çš„æ‰€æœ‰å†…å®¹åˆ° Cloudflare Pages
3. è®¾ç½®æ„å»ºå‘½ä»¤ä¸º `npm run build`

---

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜ 1: é¡µé¢æ˜¾ç¤ºç©ºç™½æˆ– 404

**åŸå› **: Cloudflare Pages éœ€è¦æ­£ç¡®çš„æ–‡ä»¶ç»“æ„

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®ä¿æ„å»ºè¾“å‡ºåŒ…å«ä»¥ä¸‹å†…å®¹
ls .next/
# åº”è¯¥çœ‹åˆ°: server/ static/ build-manifest.json ç­‰

# ä¸Šä¼ æ—¶é€‰æ‹© .next æ–‡ä»¶å¤¹çš„å…¨éƒ¨å†…å®¹
# è€Œä¸æ˜¯ .next æ–‡ä»¶å¤¹æœ¬èº«
```

### é—®é¢˜ 2: API è·¯ç”±ä¸å·¥ä½œ

**è¯´æ˜**: Cloudflare Pages ä¸»è¦æ”¯æŒé™æ€å†…å®¹
- API è·¯ç”±åœ¨ Pages ä¸Šå¯èƒ½å—é™
- æœ¬é¡¹ç›®ä¸»è¦ä¾èµ–æµè§ˆå™¨ç«¯è½¬æ¢ï¼ŒAPI ä¸æ˜¯å¿…éœ€çš„

### é—®é¢˜ 3: ä¸­é—´ä»¶ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**:
- æœ¬é¡¹ç›®çš„ä¸­é—´ä»¶ä¸»è¦ç”¨äºå®‰å…¨å¤´
- åœ¨ Pages ä¸Šå¯èƒ½éœ€è¦åœ¨ Dashboard é…ç½®

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰
- [ ] è¿è¡Œ `npm run build` æˆåŠŸ
- [ ] æ£€æŸ¥ `.next` ç›®å½•å­˜åœ¨
- [ ] ç¡®è®¤æ— æ„å»ºé”™è¯¯
- [ ] ä»£ç å·²æ¨é€åˆ° GitHub

### éƒ¨ç½²é…ç½®
- [ ] æ„å»ºå‘½ä»¤: `npm run build`
- [ ] è¾“å‡ºç›®å½•: `.next`
- [ ] æ ¹ç›®å½•: `/`

### éƒ¨ç½²åéªŒè¯
- [ ] è®¿é—®éƒ¨ç½²çš„ URL
- [ ] æ£€æŸ¥ä¸»é¡µæ˜¯å¦åŠ è½½
- [ ] æµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- [ ] æµ‹è¯•è½¬æ¢åŠŸèƒ½
- [ ] æ£€æŸ¥æ§åˆ¶å°é”™è¯¯

---

## ğŸ¯ å¦‚æœä»ç„¶æœ‰é—®é¢˜

### æ–¹æ¡ˆ A: ä½¿ç”¨é™æ€å¯¼å‡ºæ¨¡å¼

ä¿®æ”¹ `next.config.js`:
```javascript
const nextConfig = {
  output: 'export',
  images: {
    unoptimized: true,
  },
}
```

ç„¶åé‡æ–°æ„å»ºå¹¶ä¸Šä¼  `.next/export` æ–‡ä»¶å¤¹çš„å†…å®¹

### æ–¹æ¡ˆ B: ä½¿ç”¨ Vercelï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰

å¦‚æœ Cloudflare Pages æŒç»­æœ‰é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘ï¼š
```bash
# å®‰è£… Vercel CLI
npm i -g vercel

# éƒ¨ç½²
vercel
```

### æ–¹æ¡ˆ C: æ£€æŸ¥æ„å»ºè¾“å‡º

```bash
# æŸ¥çœ‹æ„å»ºç”Ÿæˆçš„æ–‡ä»¶
find .next -type f -name "*.html" -o -name "*.js" -o -name "*.css" | head -20

# æ£€æŸ¥æ˜¯å¦æœ‰ index.html
ls .next/server/app/
```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

1. **æŸ¥çœ‹æ„å»ºæ—¥å¿—**: Cloudflare Dashboard â†’ Pages â†’ ä½ çš„é¡¹ç›® â†’ Deployments
2. **æ£€æŸ¥æ§åˆ¶å°**: æµè§ˆå™¨ F12 â†’ Console
3. **éªŒè¯æ–‡ä»¶**: ç¡®ä¿ä¸Šä¼ äº†å®Œæ•´çš„ `.next` ç›®å½•å†…å®¹

---

**æç¤º**: æœ¬é¡¹ç›®ä¸»è¦ä¾èµ–æµè§ˆå™¨ Canvas APIï¼ŒæœåŠ¡å™¨ç«¯åŠŸèƒ½æœ‰é™ï¼Œå› æ­¤å³ä½¿ API è·¯ç”±ä¸å·¥ä½œï¼Œæ ¸å¿ƒè½¬æ¢åŠŸèƒ½ä¹Ÿåº”è¯¥æ­£å¸¸ï¼